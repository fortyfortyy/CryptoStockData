(function(){"use strict";var e={8445:function(e,t,o){var n=o(821),r=(o(7658),o(2201));const s={class:"navbar"},a=(0,n._)("strong",null,"Crypto Prices",-1),i=(0,n._)("strong",null,"Home",-1),c=(0,n._)("strong",null,"Sign Up",-1);function u(e,t,o,r,u,l){const h=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",s,[e.$store.state.isAuthenticated?((0,n.wg)(),(0,n.j4)(h,{key:0,to:"/stocks",class:"stock-item"},{default:(0,n.w5)((()=>[a])),_:1})):(0,n.kq)("",!0),e.$store.state.isAuthenticated?((0,n.wg)(),(0,n.iD)("button",{key:1,id:"logout",onClick:t[0]||(t[0]=e=>l.logout()),class:"logout-item"},"Log out")):((0,n.wg)(),(0,n.iD)(n.HY,{key:2},[(0,n.Wm)(h,{to:"/",class:"home-item"},{default:(0,n.w5)((()=>[i])),_:1}),(0,n.Wm)(h,{to:"/sign-up",class:"sign-up-item"},{default:(0,n.w5)((()=>[c])),_:1}),(0,n.Wm)(h,{to:"/login",class:"log-in-item"},{default:(0,n.w5)((()=>[(0,n.Uk)("Log in")])),_:1})],64))])}var l=o(196),h={name:"NavbarView",methods:{logout(){l.ZP.defaults.headers.common.Authorization="",localStorage.removeItem("access"),localStorage.removeItem("refresh"),localStorage.removeItem("username"),this.$store.commit("removeToken"),this.$router.push("/")}}},m=o(3744);const d=(0,m.Z)(h,[["render",u]]);var f=d;const p={class:"footer",id:"footer"},g=(0,n._)("p",{class:"has-text-centered"},"Copyright (C) 2022 Daniel Pacek",-1),v=[g];function k(e,t,o,r,s,a){return(0,n.wg)(),(0,n.iD)("footer",p,v)}var y={name:"FooterView"};const b=(0,m.Z)(y,[["render",k]]);var w=b,S=o(7202);const $={class:"main"},A={mounted(){this.verifyToken(),this.check_and_update_token()},methods:{async refreshToken(){if(localStorage.getItem("refresh")&&localStorage.getItem("access")){console.log("Refreshing token...");let e=localStorage.getItem("refresh"),t=localStorage.getItem("access");l.ZP.defaults.headers.common.Authorization="Bearer "+t;let o={refresh:e};await l.ZP.post("/api/account/token/refresh/",o).then((e=>{if(200!==e.status){l.ZP.defaults.headers.common.Authorization="",this.$store.removeToken();const e=this.$route.query.to||"/login";return this.$router.push(e),this.errors.push("You have to log in again."),clearInterval(this.update_timer),void console.log("Delete timer to update token")}if(!e.data.access)return l.ZP.defaults.headers.common.Authorization="",S.Z.push("/login"),this.errors.push("You have to log in again."),clearInterval(this.update_timer),void console.log("Delete timer for update token");const t=e.data.access,o=e.data.refresh;console.log("Setting up the new access and refresh tokens"),l.ZP.defaults.headers.common.Authorization="Bearer "+t,this.$store.commit("setToken",t,o),localStorage.setItem("access",t),localStorage.setItem("refresh",o)})).catch((e=>{this.$store.commit("removeToken"),this.$store.commit("removeTokenFromStorage"),clearInterval(this.update_timer),console.log("Delete timer for update token"),S.Z.push("/login"),this.errors.push("You have to log in again."),console.log(e)}))}else this.$store.commit("removeToken"),this.$store.commit("removeTokenFromStorage"),clearInterval(this.update_timer),S.Z.push("/login"),this.errors.push("You have to log in again.")},async verifyToken(){if(!this.$store.state.access)return;let e={refresh:this.$store.state.access};await l.ZP.post("api/account/token/verify/",e).then((e=>{200!==e.status?this.refreshToken():this.$store.state.isAuthenticated=!0})).catch((e=>{console.log(e),this.refreshToken()}))},check_and_update_token(){this.update_timer=setInterval((()=>{this.verifyToken()}),24e3)}},beforeCreate(){this.$store.commit("initializeStore");const e=this.$store.state.access,t=this.$store.state.refresh;if(e&&t)l.ZP.defaults.headers.common.Authorization="Bearer "+e;else{if(l.ZP.defaults.headers.common.Authorization="",clearInterval(this.update_timer),window.location.pathname.includes("activate")){let e=window.location.pathname.split("/"),t=e[2],o=e[3];const n=this.$route.query.to||`/activate/${t}/${o}`;this.$router.push(n)}if(window.location.pathname.includes("/password/set/")){let e=window.location.pathname.split("/"),t=e[3],o=e[4];const n=this.$route.query.to||`/password/set/${t}/${o}`;this.$router.push(n)}}},unmounted(){clearInterval(this.update_timer)}};var _=Object.assign(A,{__name:"App",setup(e){return(e,t)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(f),(0,n._)("div",$,[(0,n.Wm)((0,n.SU)(r.MA))]),(0,n.Wm)(w)],64))}});const T=_;var I=T,C=o(3907),P=(0,C.MT)({state:{isAuthenticated:!1,access:"",refresh:"",isLoading:!1},mutations:{initializeStore(e){localStorage.getItem("access")&&localStorage.getItem("refresh")?(e.access=localStorage.getItem("access"),e.refresh=localStorage.getItem("refresh")):(e.access="",e.refresh="",e.isAuthenticated=!1)},setIsLoading(e,t){e.isLoading=t},setToken(e,t,o){e.access=t,e.refresh=o,e.isAuthenticated=!0},removeToken(e){e.access="",e.refresh="",e.isAuthenticated=!1},removeTokenFromStorage(){localStorage.removeItem("refresh"),localStorage.removeItem("access")}},actions:{},modules:{}});l.ZP.defaults.baseURL="http://localhost:8000",(0,n.ri)(I).use(P).use(S.Z,l.ZP).mount("#app")},7202:function(e,t,o){o.d(t,{Z:function(){return f}});var n=o(2201),r=o(821);const s={class:"home"},a=(0,r.uE)('<div class="container"><h2 class="title"> Welcome to Crypto Stock! </h2></div><div class="crypto-name-container"> Would you like to check the latest prices of <strong id="btc" class="crypto-name">$BTC </strong><strong id="eth" class="crypto-name">$ETH </strong><strong id="bnb" class="crypto-name">$BNB </strong><strong id="sol" class="crypto-name">$SOL </strong><strong id="dome" class="crypto-name">$DOME </strong></div>',2);function i(e,t,o,n,i,c){return(0,r.wg)(),(0,r.iD)("div",s,[a,e.$store.state.isAuthenticated?((0,r.wg)(),(0,r.iD)("button",{key:1,onClick:t[1]||(t[1]=e=>c.prices()),class:"button"},"Click here to see prices")):((0,r.wg)(),(0,r.iD)("button",{key:0,onClick:t[0]||(t[0]=e=>c.login()),class:"button"},"Click Here"))])}o(7658);var c={name:"HomeView",mounted(){document.title="Home | StockApp"},methods:{login(){this.$router.push("/login")},prices(){this.$router.push("/stocks")}}},u=o(3744);const l=(0,u.Z)(c,[["render",i]]);var h=l;const m=[{path:"/",name:"HomeView",component:h},{path:"/login",name:"LogIn",component:()=>o.e(36).then(o.bind(o,5036))},{path:"/sign-up",name:"SignUp",component:()=>o.e(774).then(o.bind(o,2774))},{path:"/stocks",name:"StockPrices",component:()=>o.e(614).then(o.bind(o,3614))},{path:"/password/reset",name:"ForgotPassword",component:()=>o.e(661).then(o.bind(o,5661))},{path:"/password/set/:uidb/:token",name:"PasswordSet",component:()=>o.e(447).then(o.bind(o,1447))},{path:"/activate/:uidb/:token",name:"ActivateAccount",component:()=>o.e(48).then(o.bind(o,7048))}],d=(0,n.p7)({history:(0,n.PO)(),routes:m});var f=d}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,s){if(!n){var a=1/0;for(l=0;l<e.length;l++){n=e[l][0],r=e[l][1],s=e[l][2];for(var i=!0,c=0;c<n.length;c++)(!1&s||a>=s)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(i=!1,s<a&&(a=s));if(i){e.splice(l--,1);var u=r();void 0!==u&&(t=u)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[n,r,s]}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/"+e+".js"}}(),function(){o.miniCssF=function(e){return"css/"+e+".css"}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="frontendaa:";o.l=function(n,r,s,a){if(e[n])e[n].push(r);else{var i,c;if(void 0!==s)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+s){i=h;break}}i||(c=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,o.nc&&i.setAttribute("nonce",o.nc),i.setAttribute("data-webpack",t+s),i.src=n),e[n]=[r];var m=function(t,o){i.onerror=i.onload=null,clearTimeout(d);var r=e[n];if(delete e[n],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((function(e){return e(o)})),t)return t(o)},d=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),c&&document.head.appendChild(i)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/static/dist/"}(),function(){var e=function(e,t,o,n){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css";var s=function(s){if(r.onerror=r.onload=null,"load"===s.type)o();else{var a=s&&("load"===s.type?"missing":s.type),i=s&&s.target&&s.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=a,c.request=i,r.parentNode.removeChild(r),n(c)}};return r.onerror=r.onload=s,r.href=t,document.head.appendChild(r),r},t=function(e,t){for(var o=document.getElementsByTagName("link"),n=0;n<o.length;n++){var r=o[n],s=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(s===e||s===t))return r}var a=document.getElementsByTagName("style");for(n=0;n<a.length;n++){r=a[n],s=r.getAttribute("data-href");if(s===e||s===t)return r}},n=function(n){return new Promise((function(r,s){var a=o.miniCssF(n),i=o.p+a;if(t(a,i))return r();e(n,i,r,s)}))},r={143:0};o.f.miniCss=function(e,t){var o={36:1,48:1,447:1,614:1,661:1,774:1};r[e]?t.push(r[e]):0!==r[e]&&o[e]&&t.push(r[e]=n(e).then((function(){r[e]=0}),(function(t){throw delete r[e],t})))}}(),function(){var e={143:0};o.f.j=function(t,n){var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var s=new Promise((function(o,n){r=e[t]=[o,n]}));n.push(r[2]=s);var a=o.p+o.u(t),i=new Error,c=function(n){if(o.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var s=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",i.name="ChunkLoadError",i.type=s,i.request=a,r[1](i)}};o.l(a,c,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,s,a=n[0],i=n[1],c=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(c)var l=c(o)}for(t&&t(n);u<a.length;u++)s=a[u],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(l)},n=self["webpackChunkfrontendaa"]=self["webpackChunkfrontendaa"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(8445)}));n=o.O(n)})();
//# sourceMappingURL=app.js.map